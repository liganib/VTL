 


  <div class="row no-gutters">
    <div class="col-lg-12 col-xl-9 py-3">
            <h1 id="examples_toc_vtl-examples">VTL Examples</h1> 
<p>Those examples show how to use pre-existing data and some simple manipulations.</p> 
<p>After creating a session, paste the code snippets into the editor and use the Dataset Explorer to browse the results.</p> 
<section> 
 <h2 id="examples_toc_arithmetics-on-scalar-values">Arithmetics on scalar values</h2> 
 <p>This example shows how to perform simple arithmetics manipulations on scalar data:</p> 
 <div class="source"> 
  <div class="source"> 
   <pre>a := 0.1;
b := 3;
c := abs(sqrt(14 + a));
d := a + b + c;
e := c + d / a;
f := e - d;
g := -f;
test := a * b + c / a;
</pre> 
  </div> 
 </div> 
</section> 
<section> 
 <h2 id="examples_toc_pulling-data-from-r">Pulling data from R</h2> 
 <p>This example shows how to manipulate into the VTL engine an R data frame that is defined in the R global environment.</p> 
 <section> 
  <h3 id="examples_toc_r-code">R code</h3> 
  <p>First prepare the data inside your R session:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre># retrieve gbp and usd rates from the ECB SDMX web service
usd &lt;- getTimeSeriesTable('ECB', 'EXR.A.USD+GBP.EUR.SP00.A')
# set needed metadata for VTL engine (identifiers and measures)
attr(usd, 'measures') &lt;- 'OBS_VALUE'
attr(usd, 'identifiers') &lt;- c('TIME_PERIOD', 'CURRENCY')
</pre> 
   </div> 
  </div> 
  <p>Note that if you access internet through a proxy server, you may need to configure it to replicate this example.</p> 
  <h3 id="examples_toc_r-code">VTL code</h3> 
  <p>After your data is prepared, you may start vtlStudio, create a new session, and run the example:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>/* create dataset for USD rate */
usd := rates[filter CURRENCY="USD"];
/* create dataset for GBP rate */
gbp := rates[filter CURRENCY="GBP"];
/* filter on time period */ 
usd_post_2000 := usd[filter TIME_PERIOD &gt;  "2000"];
</pre> 
   </div> 
  </div> 
  <p>You may view the resulting <code>usd_post_2000</code> dataset in the explorer.</p> 
 </section> 
</section> 
<section> 
 <h2 id="examples_toc_pulling-data-from-web-services">Pulling data from web services</h2> 
 <p>This example shows how to leverage the SDMX Connectors to directly pull data from a SDMX 2.1 compliant web service.</p> 
 <p>In the snippet the ECB SDMX web service is used as an example.</p> 
 <p>Note that if you access internet through a proxy server, you may need to configure it to replicate this example.</p> 
 <div class="source"> 
  <div class="source"> 
   <pre>/* Retrieve food and beverages monthly component value */
compOfBasket := 'sdmx:ECB.ICP.M.U2.N.010000.4.ANR'[keep OBS_VALUE]
	[calc identifier YEAR := cast(time_agg("A", TIME_PERIOD), time, "")];

/* Retrieve annual component weight */
compWeight := 'sdmx:ECB.ICP.A.U2.N.010000.4.INW'
	[keep OBS_VALUE]
	[rename OBS_VALUE to WEIGHT, TIME_PERIOD to YEAR];

/* Join to calculate monthly weight */
monthlyWeight := inner_join(compWeight, compOfBasket)
	[keep WEIGHT]
	[rename WEIGHT to OBS_VALUE] / 1000;

/* Calculate component contribution */
calculated := compOfBasket * monthlyWeight;

/* Retrieve contribution from the provider */
expected := 'sdmx:ECB.ICP.M.U2.N.010000.3.CTG'
	[keep OBS_VALUE]
	[rename OBS_VALUE to expected_value];

/* Join to compare and calculate percentual error for easy comparison */
errors := inner_join(calculated, expected)
	[calc errorPerc := abs((OBS_VALUE - expected_value) / expected_value) * 100];
</pre> 
  </div> 
 </div> 
</section> 
<section> 
 <h2 id="examples_toc_loading-csv-data-from-file-system">Loading CSV data from file system</h2> 
 <p>This example shows how to load data from a CSV file with a modified header that complies with a predefined structure.</p> 
 <p>Example files are available in the package installation directory: <code>&lt;package_root&gt;/vtlStudio2/test_data</code>.</p> 
 <div class="source"> 
  <div class="source"> 
   <pre>/* Load csv */ 
usd := 'csv:&lt;package_root&gt;/vtlStudio2/test_data/ecbexrusd_vtl.csv';

/* Filter on time period */ 
usd_post_2000 := usd[filter TIME_PERIOD &gt;  "2000"];
</pre> 
  </div> 
 </div> 
</section>
        </div>
    <div class="d-none d-sm-none d-md-none d-lg-none d-xl-block col-xl-3">
        <div class="feedback-links">
            <ul class="nav flex-column flex-nowrap">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/vpinna80/VTL/RVTL/src\site\markdown/examples.md.vm"><i class="far fa-edit" target="_blank" rel="noopener noreferrer"></i> Improve this page</a>
                </li>
            </ul>
        </div>
            <div id="m-toc-sidebar" class="d-print-none m-toc-sidebar-enabled m-toc-sidebar-expanded toc-sidebar-fixed">
                <nav id="m-toc-sidebar-nav flex-column">
                <ul class="m-nav--sidebar nav flex-column flex-nowrap">
    <li class="h1">
        <a class="nav-link" href="#examples_toc_vtl-examples" title="VTL Examples">VTL Examples</a>
    </li>
    <li class="h2">
        <a class="nav-link" href="#examples_toc_arithmetics-on-scalar-values" title="Arithmetics on scalar values">Arithmetics on scalar values</a>
    </li>
    <li class="h2">
        <a class="nav-link" href="#examples_toc_pulling-data-from-r" title="Pulling data from R">Pulling data from R</a>
    </li>
    <li class="h2">
        <a class="nav-link" href="#examples_toc_pulling-data-from-web-services" title="Pulling data from web services">Pulling data from web services</a>
    </li>
    <li class="h2">
        <a class="nav-link" href="#examples_toc_loading-csv-data-from-file-system" title="Loading CSV data from file system">Loading CSV data from file system</a>
    </li>
                    </ul>
                </nav>
           </div>
    </div>
</div>
